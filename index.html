<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Mithila College Help - Online Services</title>

    <script async src="https://www.googletagmanager.com/gtag/js?id=G-2G01CRRFP1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-2G01CRRFP1');
    </script>

    <style>
        /* CSS Variables */
        :root {
            --tiranga-orange: #FF9933;
            --tiranga-green: #138808;
            --blue-highlight: #007BFF;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        /* ==== Background and Chakra Animation ==== */
        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(120deg, var(--tiranga-orange), #ffffff, var(--tiranga-green));
            background-size: 300% 300%;
            animation: gradientShift 10s ease infinite;
            position: relative;
            overflow-x: hidden;
            color: #111;
        }
        @keyframes gradientShift { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }
        body::before {
            content: ""; position: fixed; top: 50%; left: 50%; width: 260px; height: 260px;
            background: url('https://upload.wikimedia.org/wikipedia/commons/1/17/Ashoka_Chakra.svg') no-repeat center;
            background-size: contain; opacity: 0.12; transform: translate(-50%, -50%) rotate(0deg);
            animation: chakraRotate 25s linear infinite; pointer-events: none; z-index: 0;
        }
        @keyframes chakraRotate { 0% { transform: translate(-50%, -50%) rotate(0deg); } 100% { transform: translate(-50%, -50%) rotate(360deg); } }

        html { scroll-behavior: smooth; }

        /* ==== Main Content and Header ==== */
        #main-content {
            position: relative; z-index: 2;
            min-height: 100vh;
        }
        header { padding: 25px 0; background: rgba(255,255,255,0.75); backdrop-filter: blur(6px); border-bottom: 3px solid rgba(0,0,0,0.2); box-shadow: 0 4px 10px rgba(0,0,0,0.2); text-align: center; }
        .header-content { display: flex; flex-direction: column; align-items: center; gap: 8px; }
        .header-content img { width: 100px; height: 100px; border-radius: 50%; border: 3px solid #fff; box-shadow: 0 4px 12px rgba(0,0,0,0.3); object-fit: cover; }
        .site-title { font-size: 28px; font-weight: 700; color: #000; }
        nav { background: rgba(0,0,0,0.8); padding: 12px 0; border-radius: 0 0 15px 15px; text-align: center; }
        nav a { color: white; text-decoration: none; margin: 0 14px; font-weight: 600; transition: 0.3s; }
        nav a:hover { color: #ffcc33; text-shadow: 0 0 10px rgba(255,255,255,0.7); }
        
        /* ==== Main Body (White Card) ==== */
        main {
            max-width: 1000px; margin: 30px auto; background: rgba(255,255,255,0.9); padding: 25px; border-radius: 15px; box-shadow: 0 6px 25px rgba(0,0,0,0.15);
        }
        h2.section-title { margin-top: 20px; font-size: 20px; color: var(--tiranga-green); border-left: 5px solid var(--tiranga-orange); padding-left: 10px; }
        
        /* ==== Services Grid & List Styling ==== */
        .service-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 12px; margin-top: 10px; list-style: none; padding: 0;}
        .service-grid li { background: #f8fafc; padding: 12px; border-radius: 10px; border: 1px solid #e3e9f3; transition: 0.3s; }
        .service-grid li:hover { transform: translateY(-4px); box-shadow: 0 6px 14px rgba(0,0,0,0.12); }
        .service-grid a { color: var(--blue-highlight); font-weight: 600; text-decoration: none; }
        .service-grid a:hover { text-decoration: underline; }
        
        /* ==== Search Bar ==== */
        #searchBox { width: 100%; padding: 12px 15px; border-radius: 30px; border: 2px solid #444; font-size: 1rem; outline: none; margin-top: 10px; margin-bottom: 20px; box-sizing: border-box; }
        #searchBox:focus { border-color: var(--tiranga-green); box-shadow: 0 0 10px rgba(19,136,8,0.6); }

        /* ==== Buttons ==== */
        .perm-btn, button { background: linear-gradient(to right, var(--tiranga-orange), var(--tiranga-green)); border: none; color: #000; font-weight: 600; padding: 10px 20px; border-radius: 30px; cursor: pointer; transition: 0.3s; margin: 10px 5px; display: inline-block; }
        .perm-btn:hover, button:hover { transform: scale(1.05); }

        /* ==== ID Card Styling (using previous variables) ==== */
        .id-input-group { display: flex; gap: 10px; flex-wrap: wrap; margin-bottom: 10px;}
        .id-input-group input, #id_photo { flex: 1; padding: 8px; border-radius: 6px; border: 1px solid #ccc; box-sizing: border-box; }
        
        /* ==== Footer ==== */
        footer { background: rgba(0,0,0,0.85); color: #fff; text-align: center; padding: 12px; margin-top: 20px; border-top: 3px solid var(--tiranga-green); border-radius: 0 0 10px 10px; }
        
        @media (max-width:700px){ .header-content img { width:80px; height:80px; } nav a { display:inline-block; margin:5px 8px; } }
    </style>
</head>

<body>
    <div id="main-content">
        <header>
            <div class="header-content">
                <img src="gandhi.logo.png" alt="Mithila College Logo">
                <div class="site-title">MITHILA COLLEGE HELP</div>
            </div>
            <nav>
                <a href="index.html">Home</a>
                <a href="about.html">About</a>
                <a href="services.html">Online Services</a>
                <a href="contact.html">Contact</a>
                <a href="help.html">Help</a>
            </nav>
        </header>

        <main>
            <h2 class="section-title">üîç Search Services</h2>
            <input type="text" id="searchBox" placeholder="‡§∏‡•á‡§µ‡§æ‡§è‡§Å ‡§ñ‡•ã‡§ú‡•á‡§Ç (LNMU, Bhumi, eShram, Recharge...)" onkeyup="filterLinks()">
            <br>
            
            <h2 class="section-title">üîê Permission Access</h2>
            <p>‡§µ‡•á‡§¨‡§∏‡§æ‡§á‡§ü ‡§ï‡•Ä ‡§µ‡§ø‡§∂‡§ø‡§∑‡•ç‡§ü ‡§∏‡•á‡§µ‡§æ‡§ì‡§Ç (‡§ú‡•à‡§∏‡•á ‡§´‡•ã‡§ü‡•ã ‡§Ö‡§™‡§≤‡•ã‡§°) ‡§ï‡§æ ‡§â‡§™‡§Ø‡•ã‡§ó ‡§ï‡§∞‡§®‡•á ‡§∏‡•á ‡§™‡§π‡§≤‡•á ‡§™‡§∞‡§Æ‡§ø‡§∂‡§® ‡§¶‡•á‡§Ç‡•§</p>
            <button id="requestPermBtn" class="perm-btn">Allow Access Now</button>
            <hr style="margin:20px 0; border:1px solid #e0e0e0;">

            <h2 class="section-title">üéì LNMU & Colleges</h2>
            <ul class="service-grid">
                <li><a href="https://lnmu.ac.in/" target="_blank">üåê LNMU Official Website</a></li>
                <li><a href="https://lnmuniversity.com/LNMU_ERP/Home.aspx/" target="_blank">üìò LNMU Student Portal UG</a></li>
                <li><a href="https://lnmuniversity.com/" target="_blank">üßæ Exam Form / Admit Card</a></li>
                <li><a href="https://mmtmcollege.ac.in/" target="_blank">üè´ M.M.T.M College</a></li>
                <li><a href="https://www.mithilacollege.in/" target="_blank">Mithila College, Darbhanga</a></li>
                <li><a href="https://www.cmclnmu.ac.in/" target="_blank">CM College, Darbhanga</a></li>
                <li><a href="https://www.marwari-college.in/" target="_blank">Marwari College, Darbhanga</a></li>
                <li><a href="https://mlscollege.ac.in/" target="_blank">M.L.S.M College</a></li>
                <li><a href="https://mahila-college-dbg.ac.in/" target="_blank">Mahila College, Darbhanga</a></li>
            </ul>

            <h2 class="section-title">üåê Bihar Government Services</h2>
            <ul class="service-grid">
                <li><a href="https://serviceonline.bihar.gov.in/" target="_blank">üßæ Service Plus Portal</a></li>
                <li><a href="https://biharbhumi.bihar.gov.in/" target="_blank">üåè Bihar Bhumi (Land Records)</a></li>
                <li><a href="https://epds.bihar.gov.in/" target="_blank">üçö EPDS (Ration Card)</a></li>
                <li><a href="https://eshram.gov.in/" target="_blank">üßç eShram Card</a></li>
                <li><a href="https://myaadhaar.uidai.gov.in/" target="_blank">ü™™ Aadhaar Portal</a></li>
                <li><a href="https://abha.abdm.gov.in/" target="_blank">üè• ABHA / Ayushman Card</a></li>
                <li><a href="https://brabu.net/" target="_blank">üéì BRABU University</a></li>
                <li><a href="https://brabu.ucanapply.com/" target="_blank">üìù BRABU Admission Portal</a></li>
                <li><a href="https://state.bihar.gov.in/" target="_blank">üèõ Bihar Govt Official Site</a></li>
            </ul>

            <h2 class="section-title">üÜî College ID Card Generator</h2>
            <div style="max-width:700px;">
                <div class="id-input-group">
                    <input id="id_name" placeholder="Student's Name" value="‡§µ‡§ø‡§ï‡•ç‡§∞‡§Æ ‡§≠‡§ó‡§§" required>
                    <input id="id_univroll" placeholder="University Roll" value="8989" required>
                </div>
                <div class="id-input-group">
                    <input id="id_father" placeholder="Father's Name" value="‡§™‡•Ä.‡§ï‡•á. ‡§∏‡§ø‡§Ç‡§π" required>
                    <input id="id_session" placeholder="Session (e.g., 2023-26)" style="width:180px;" value="2023-27" required>
                </div>
                <div class="id-input-group">
                    <input id="id_course" placeholder="Course / Dept" value="B.Sc (Physics Hons.)" required>
                    <input id="id_mobile" placeholder="Mobile No." style="width:180px;" value="65256699995">
                </div>
                <div class="id-input-group">
                    <input id="id_address" placeholder="Address" value="‡§¶‡§∞‡§≠‡§Ç‡§ó‡§æ, ‡§¨‡§ø‡§π‡§æ‡§∞" required>
                </div>
                
                <div style="display:flex;gap:10px;align-items:center;flex-wrap:wrap;margin-top:10px;">
                    <input type="file" id="id_photo" accept="image/*" style="padding:6px; flex: 1;">
                    <button id="previewBtn" class="perm-btn" style="background:linear-gradient(90deg,#28a745,#20c997);">Preview ID</button>
                    <button id="downloadPDFBtn" class="perm-btn">Download PDF</button>
                </div>
                
                <div id="id_preview" style="margin-top:14px;display:none;max-width:800px;"></div>
            </div>
            <br>
        </main>

        <footer>
            ¬© 2019 Mithila College Help ‚Äî Developed ‚ù§Ô∏è by VIKRAM KUMAR SINGH 6200732472
        </footer>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    
    <script>
        // Global Photo Variable and Sound
        let photoData = '';
        const welcomeSound = new Audio("https://cdn.pixabay.com/download/audio/2023/03/28/audio_8e8c4e2ddc.mp3?filename=success-1-6297.mp3");
        try { welcomeSound.play().catch(()=>{}); } catch(e){};
        
        // =================================================================
        // 2. SEARCH FILTER LOGIC (Global Function for onkeyup in HTML)
        // =================================================================
        window.filterLinks = function() {
            const val = document.getElementById('searchBox').value.toLowerCase();
            document.querySelectorAll('.service-grid li').forEach(li => { 
                li.style.display = li.textContent.toLowerCase().includes(val) ? '' : 'none';
            });
        }
        
        // =================================================================
        // 3. ID CARD GENERATOR LOGIC (Defined inside DOMContentLoaded for strict scoping)
        // =================================================================
        document.addEventListener('DOMContentLoaded', () => {
            const btn = document.getElementById('requestPermBtn');
            const idPhotoInput = document.getElementById('id_photo');
            const previewBtn = document.getElementById('previewBtn');
            const downloadPDFBtn = document.getElementById('downloadPDFBtn'); // Updated ID
            
            // Helper function to get input values
            const v = id => document.getElementById(id)?.value || "";

            // ** QR Code Generator **
            const generateQR = (text) => {
                const box = document.getElementById("qrBox");
                if (!box) return;
                box.innerHTML = "";
                new QRCode(box, {
                    text: text,
                    width: 120,
                    height: 120
                });
            }

            // ** Preview Function Definition **
            const previewIdCard = () => {
                const roll = v("id_univroll");
                const sessionStart = v("id_session").split('-')[0];
                const cardNo = `MC-${roll}-${sessionStart || '2023'}`;
                
                const prev = document.getElementById('id_preview');
                if (!prev) return; 

                prev.style.display='block';
                prev.innerHTML = `
                  <div id="printArea" style="display:flex;justify-content:center;gap:20px;flex-wrap:wrap">
                    
                    <div style="width:360px;border:4px solid var(--tiranga-green);border-radius:14px;padding:12px;background:#fff;font-family:Poppins">
                        <h4 style="text-align:center;margin:0;color:#c00">MAHARAJ MAHESH THAKUR MITHILA COLLEGE</h4>
                        <small style="display:block;text-align:center">Darbhanga, Bihar</small>
                        <hr>
                        <div style="display:flex;gap:10px;font-size:13px">
                            <div style="width:95px;height:120px;border:1px solid var(--tiranga-orange)">
                            ${photoData
                                ? `<img src="${photoData}" style="width:100%;height:100%;object-fit:cover">`
                                : `<small style="display:block;text-align:center;margin-top:50px">Photo</small>`}
                            </div>
                            <div>
                                <div><b>Name:</b> ${v("id_name")}</div>
                                <div><b>Father:</b> ${v("id_father")}</div>
                                <div><b>Course:</b> ${v("id_course")}</div>
                                <div><b>Session:</b> ${v("id_session")}</div>
                                <div><b>Mobile:</b> ${v("id_mobile")}</div>
                                <div><b>Univ Roll:</b> ${roll}</div>
                                <div><b>Card No:</b> ${cardNo}</div>
                            </div>
                        </div>
                    </div>

                    <div style="width:360px;border:4px solid var(--blue-highlight);border-radius:14px;padding:12px;background:#f8f9fa;font-family:Poppins">
                        <h4 style="text-align:center;margin:0">OFFICIAL INFO</h4>
                        <hr>
                        <p style="font-size:13px"><b>Address:</b><br>${v("id_address")}</p>
                        <div id="qrBox" style="width:120px;height:120px;margin:auto"></div>
                        <small style="display:block;text-align:center">Scan QR Code</small>
                    </div>
                  </div>`;
                
                // QR Code Generation
                setTimeout(() => generateQR(cardNo), 200);
            };


            // ** Print/Save (Download PDF) Function Definition **
            const downloadPDF = () => {
                const area = document.getElementById("printArea");
                if (!area) return alert("‡§™‡§π‡§≤‡•á Preview ‡§ï‡§∞‡•á‡§Ç");

                html2pdf().from(area).set({
                    filename: `MMTM_College_ID_Card_${v("id_name")}.pdf`,
                    html2canvas: { scale: 3 }
                }).save();
            };


            // =================================================================
            // 1. EVENT LISTENERS (Attaching functions to buttons)
            // =================================================================
            
            // Photo Load Listener
            if (idPhotoInput) {
                idPhotoInput.addEventListener('change', e => {
                    const file = e.target.files[0]; 
                    if (!file) return;
                    const reader = new FileReader(); 
                    reader.onload = () => {
                        photoData = reader.result;
                        previewIdCard(); // Auto-preview after photo load
                    };
                    reader.readAsDataURL(file);
                });
            }

            // Preview Button Listener
            if (previewBtn) {
                previewBtn.addEventListener('click', previewIdCard);
            }

            // Download PDF Button Listener
            if (downloadPDFBtn) {
                downloadPDFBtn.addEventListener('click', downloadPDF);
            }

            // Permission Button Logic (unchanged)
            if(btn) {
                btn.addEventListener('click', async () => {
                    btn.textContent = "Requesting...";
                    btn.disabled = true;
                    try { await navigator.mediaDevices.getUserMedia({ audio: true }).catch(()=>{}); alert("üé§ Mic Access Status: Requested"); } catch(e){}
                    try { await navigator.mediaDevices.getUserMedia({ video: true }).catch(()=>{}); alert("üì∑ Camera Access Status: Requested"); } catch(e){}
                    try { await new Promise(r => navigator.geolocation.getCurrentPosition(()=>r(), ()=>r(), {timeout:5000})); alert("üìç Location Access Status: Requested"); } catch(e){}
                    btn.textContent = "Access Requested (Green)";
                    btn.style.background = 'linear-gradient(to right, #138808, #28a745)';
                });
            }
        });

    </script>
</body>
</html>
